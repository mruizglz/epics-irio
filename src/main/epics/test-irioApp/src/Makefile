#+======================================================================
# $HeadURL: https://svnpub.codac.iter.org/codac/iter/codac/dev/units/m-epics-iter-templates/tags/CODAC-CORE-7.1A1/templates/genericApp/src/Makefile $
# $Id: Makefile 129079 2022-02-21 11:00:35Z langer $
#
# Project       : CODAC Core System
#
# Description   : Makefile
#
# Author(s)     : This file was generated by CODAC development toolkit
#
# Copyright (c) : 2010-2022 ITER Organization,
#                 CS 90 046
#                 13067 St. Paul-lez-Durance Cedex
#                 France
#
# This file is part of ITER CODAC software.
# For the terms and conditions of redistribution or use of this software
# refer to the file ITER-LICENSE.TXT located in the top level directory
# of the distribution package.
#
#-======================================================================
TOP=../..

include $(TOP)/configure/CONFIG



#----------------------------------------
#  ADD MACRO DEFINITIONS BELOW HERE
#=============================
# Declare LabVIEW resources
IRIO_FPGA_DIR = LVtest-irio/FPGA_Bitfiles

IRIO_FPGA += NiFpga_FlexRIOMod5761_7966v1_1.h  NiFpga_FlexRIOMod5761_7966v1_1.lvbitx
# Use typed rset structure (see 3.16.1 release notes)
USR_CPPFLAGS += -DUSE_TYPED_RSET

#=============================
# Build the IOC application

PROD_IOC += test-irio

# test-irio.dbd will be created and installed
DBD += test-irio.dbd

# test-irio_registerRecordDeviceDriver.cpp derives from test-irio.dbd
test-irio_SRCS += test-irio_registerRecordDeviceDriver.cpp

# Build the main IOC entry point where needed
test-irio_SRCS_DEFAULT += test-irioMain.cpp
test-irio_SRCS_vxWorks += -nil-

#=============================
# Include makefile snippets to add support for additional modules
USR_CPPFLAGS += -fPIC -g -O0
include $(EPICS_ROOT)/mk/codac-common.mk
include $(EPICS_ROOT)/mk/asyn.mk
EPICSIRIO_DIR = $(TOP)/lib
IRIOCORE_DIR = /opt/codac/lib
EPICSIRIO_LIB=irio-epics
USR_SYS_LIBS += irioCore
test-irio_DBD  += $(CODAC_DBD) irioAsyn.dbd asyn.dbd
test-irio_LIBS += $(EPICSIRIO_LIB) $(CODAC_LIBS)  asyn

#=============================
# Include SNL program makefile snippets

-include ../*.snlprog

# Link QSRV (pvAccess Server) if available
ifdef EPICS_QSRV_MAJOR_VERSION
    test-irio_LIBS += qsrv
    test-irio_LIBS += $(EPICS_BASE_PVA_CORE_LIBS)
    test-irio_DBD += PVAServerRegister.dbd
    test-irio_DBD += qsrv.dbd
endif

#=============================
# Finally link IOC to the EPICS Base libraries

test-irio_LIBS += $(EPICS_BASE_IOC_LIBS)

#=============================

include $(TOP)/configure/RULES
#----------------------------------------
#  ADD RULES AFTER THIS LINE
